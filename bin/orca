#!/usr/bin/env php
<?php

/**
 * @file
 * ORCA command line executable.
 */

use Consolidation\AnnotatedCommand\CommandFileDiscovery;
use Robo\Runner;

if (file_exists(__DIR__ . '/../vendor/autoload.php')) {
  $class_loader = require __DIR__ . '/../vendor/autoload.php';
}
elseif (file_exists(__DIR__ . '/../../../autoload.php')) {
  $class_loader = require __DIR__ . '/../../../autoload.php';
}
else {
  die("Could not find autoloader. Run 'composer install' first.\n");
}

$discovery = new CommandFileDiscovery();
$discovery->setSearchPattern('*Command.php');
$command_classes = $discovery->discover(__DIR__ . '/../src/Command', 'Acquia\Orca\Robo\Plugin\Commands');
$runner = new Runner($command_classes);
$runner->setClassLoader($class_loader);
$status_code = $runner->execute($_SERVER['argv'], 'ORCA', 'v0.0.1');

exit($status_code);
